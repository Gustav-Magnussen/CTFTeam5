

After access has been gained to the Wordpress site, we have to do some additional steps to be able to gain terminal access to a user. As previously found in the logs, the user we want initial access to is `www-data`, which should be the default user running a webserver. This is because if `root` ran a webserver, all files would be accessible if the webserver is compromised. `www-data` is a user that has lower privileges, meaning a lower change of further damage after initial access.

As the logs also state, the attacker put a reverse shell within the `404.php` file within the `twentytwentyone` theme in Wordpress. This is a standard theme, which is also the only theme that is activated in this instance of Wordpress. The `404.php` file is a good file to replace with a reverse shell since it only shows error messages. Replacing other files like `functions.php` (which controls the whole theme) could result in the website not working properly, thus either raising an alarm towards the real owner or making it more difficult for us as attackers to utilize the reverse shell.

> Why a reverse shell? A reverse shell enables the attacker to make the victim connect to us, making it more straightforward than gaining a regular shell. Since we already have access to the Wordpress site, using a reverse shell is one of the "easiest" ways of gaining a terminal connection.

When access to the `404.php` file is made, one has to find a proper reverse shell script to enter. There are many different reverse shells based on language, terminal/non-terminal, and resources available. In this instance, we know the webserver runs PHP (as the file is named 404.php), making it feasible to find a reverse shell written in PHP. Doing a quick Google search for "reverse shell php" results in the Pentest Monkey's GitHub repository: https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php. This is a widely used script for PHP reverse shell, and is something we will try. The picture below showcases that the `404.php` file contents has been replaced with the PHP reverse shell, and that the IP and PORT is changed according to our IP and our desired listening port:
